

<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
</head>
<body>
  <h1>SVG test</h1>


<div class="context-box1 xxx-highlight-max" style="width: 800px">
  <div class="fancybox-auto" style="width: 100%">
<svg version="1.1" baseProfile="full" viewBox="0 0 3229 2529" xmlns="http://www.w3.org/2000/svg">
  <image href="./assets/stack-detailed.png" x="0" y="0" height="100%" width="100%"/>
  
  <!-- Data Highlights -->
  <rect class="svg-highlight prepared data-all" x="0%" y="82%" width="84%" height="18%"/>
  <rect class="svg-highlight prepared data-data" x="19%" y="82%" width="64%" height="18%"/>
  <rect class="svg-highlight prepared data-assets-all" x="3%" y="82%" width="33%" height="18%"/>
  <rect class="svg-highlight prepared data-assets-app" x="3%" y="82%" width="17%" height="10%"/>
  <rect class="svg-highlight prepared data-assets-entities" x="18.5%" y="82%" width="17%" height="10%"/>

  <rect class="svg-highlight prepared data-configuration" x="3%" y="93%" width="17%" height="6.5%"/>

  <rect class="svg-highlight prepared data-entities" x="34%" y="82%" width="33%" height="10.5%"/>
  <rect class="svg-highlight prepared data-content-types" x="34%" y="89%" width="33%" height="10%"/>
  <rect class="svg-highlight prepared data-content-types-app" x="34%" y="89%" width="17.5%" height="10%"/>
  <rect class="svg-highlight prepared data-content-types-global" x="50%" y="89%" width="17%" height="10%"/>
  <rect class="svg-highlight prepared data-external" x="65.5%" y="82%" width="17%" height="10.5%"/>

  <!-- ADAM -->
  <rect class="svg-highlight prepared adam" x="18.5%" y="89%" width="17%" height="8%"/>

  <!-- Server -->
  <rect class="svg-highlight prepared server-all" x="0%" y="41%" width="84%" height="38%"/>


  <!-- Prepare -->
  <rect class="svg-highlight prepared prepare-all" x="0%" y="61%" width="84%" height="18%"/>
  <rect class="svg-highlight prepared query" x="44.5%" y="61%" width="34%" height="18%"/>
  <rect class="svg-highlight prepared query-engine" x="44.5%" y="70%" width="34%" height="7%"/>
  <rect class="svg-highlight prepared query-built-in" x="44.5%" y="62.5%" width="18%" height="11%"/>
  <rect class="svg-highlight prepared query-app" x="60.5%" y="62.5%" width="17%" height="11%"/>
  <rect class="svg-highlight prepared query-datasource" x="71%" y="70%" width="7%" height="7%"/>
  <rect class="svg-highlight prepared query-params" x="65%" y="70%" width="10%" height="7%"/>

  <!-- Data Source -->
  <rect class="svg-highlight prepared datasource" x="86%" y="51%" width="13%" height="16%"/>
  <rect class="svg-highlight prepared datasource-custom" x="87.5%" y="54.5%" width="12%" height="6%"/>
  <rect class="svg-highlight prepared datasource-built-in" x="87.5%" y="59%" width="12%" height="7%"/>
  <rect class="svg-highlight prepared lookup" x="86%" y="66%" width="13%" height="15%"/>
  <rect class="svg-highlight prepared lookup-engine" x="87.5%" y="69%" width="12%" height="6%"/>
  <rect class="svg-highlight prepared lookup-sources" x="87.5%" y="73%" width="12%" height="7%"/>

  <!-- Optimzers -->
  <rect class="svg-highlight prepared asset-optimizer" x="3%" y="49.5%" width="13.5%" height="8%"/>
  <rect class="svg-highlight prepared image-resizer" x="15%" y="30%" width="17%" height="34%"/>

  <!-- Process / Awesomize -->
  <rect class="svg-highlight prepared process-all" x="0%" y="41%" width="84%" height="18%"/>
  <rect class="svg-highlight prepared process-cs" x="34%" y="41%" width="33%" height="18%"/>
  <rect class="svg-highlight prepared process-razor" x="34.3%" y="42%" width="17%" height="15%"/>
  <rect class="svg-highlight prepared process-razor-app" x="34.3%" y="42%" width="17%" height="10%"/>
  <rect class="svg-highlight prepared process-razor-engine" x="34.3%" y="50%" width="17%" height="7%"/>
  <rect class="svg-highlight prepared process-apis" x="50%" y="42%" width="34%" height="15%"/>
  <rect class="svg-highlight prepared process-web-api" x="50%" y="42%" width="17%" height="15%"/>
  <rect class="svg-highlight prepared process-web-api-app" x="50%" y="42%" width="17%" height="10%"/>
  <rect class="svg-highlight prepared process-web-api-engine" x="50%" y="50%" width="17%" height="7%"/>
  <rect class="svg-highlight prepared process-libraries" x="47%" y="47%" width="7%" height="7%"/>
  <rect class="svg-highlight prepared process-headless" x="65.5%" y="49.5%" width="17%" height="7%"/>

  <!-- Libraries -->
  <rect class="svg-highlight prepared libraries" x="86%" y="38%" width="13%" height="15%"/>
  <rect class="svg-highlight prepared libraries-app" x="87.5%" y="41%" width="12%" height="6.5%"/>
  <rect class="svg-highlight prepared libraries-built-in" x="87.5%" y="46%" width="12%" height="6%"/>


  <!-- data formats -->
  <rect class="svg-highlight prepared format-json-custom" x="50%" y="32%" width="17%" height="14%"/>
  <rect class="svg-highlight prepared format-json-headless" x="65.5%" y="32%" width="17%" height="21%"/>
  <rect class="svg-highlight prepared format-json-edit" x="74%" y="30%" width="19%" height="23%"/>

  <!-- Browser -->
  <rect class="svg-highlight prepared browser-all" x="0%" y="0%" width="100%" height="34%"/>
  <rect class="svg-highlight prepared browser-show" x="0%" y="0%" width="50%" height="34%"/>
  <rect class="svg-highlight prepared browser-interact-edit" x="47%" y="0%" width="37%" height="34%"/>
  <rect class="svg-highlight prepared browser-interact" x="47%" y="0%" width="20.5%" height="34%"/>
  <rect class="svg-highlight prepared browser-edit" x="64%" y="0%" width="20.5%" height="34%"/>
  <rect class="svg-highlight prepared browser-edit-ui" x="81.5%" y="0%" width="18%" height="34%"/>
  
  <!-- Frameworks -->
  <rect class="svg-highlight prepared frameworks-browser" x="0%" y="0%" width="17.5%" height="34%"/>
  <rect class="svg-highlight prepared frameworks-CSS" x="0%" y="3%" width="17.5%" height="12%"/>
  <rect class="svg-highlight prepared frameworks-js" x="0%" y="12%" width="17.5%" height="12%"/>
  <rect class="svg-highlight prepared frameworks-spa" x="0%" y="21%" width="17.5%" height="12%"/>

  <!-- App show parts -->
  <rect class="svg-highlight prepared show-html" x="15.8%" y="3%" width="17.5%" height="12%"/>
  <rect class="svg-highlight prepared show-js" x="15.8%" y="12%" width="17.5%" height="12%"/>
  <rect class="svg-highlight prepared show-spa" x="15.8%" y="21%" width="17.5%" height="12%"/>

  <!-- Interact parts -->
  <rect class="svg-highlight prepared interact-mobile" x="48.5%" y="3%" width="17.5%" height="12%"/>
  <rect class="svg-highlight prepared interact-2sxc" x="48.5%" y="12%" width="17.5%" height="12%"/>
  
  <!-- Edit parts -->
  <rect class="svg-highlight prepared edit-auto" x="65.5%" y="3%" width="17.5%" height="12%"/>
  <rect class="svg-highlight prepared edit-custom" x="65.5%" y="12%" width="17.5%" height="12%"/>

  <!-- Edit UI parts -->
  <rect class="svg-highlight prepared edit-ui" x="82.5%" y="3%" width="17.5%" height="18%"/>
  <rect class="svg-highlight prepared edit-ui-custom" x="82.5%" y="20%" width="17.5%" height="12%"/>
  
  <!-- SPA parts -->
  <rect class="svg-highlight prepared spa-all" x="0%" y="21%" width="83%" height="12%"/>
  <rect class="svg-highlight prepared spa-2sxc-js" x="31.5%" y="21%" width="52%" height="12%"/>
  

  <!-- Custom highlight boxes - can be controlled by in-page CSS -->
  <rect class="svg-highlight highlight1"/>
  <rect class="svg-highlight highlight2"/>
  <rect class="svg-highlight highlight3"/>
  <rect class="svg-highlight highlight4"/>
  <rect class="svg-highlight highlight5"/>
</svg>

    
  </div>
</div>

  <!-- <div class="fancybox-auto context-box2" style="width: 100%" id="test-image">
    <svg version="1.1" baseProfile="full" viewBox="0 0 3229 2529" xmlns="http://www.w3.org/2000/svg">
      <image href="../assets/stack-detailed.png" x="0" y="0" height="100%" width="100%"/>
      <rect class="svg-highlight highlight1"/>
      <rect class="svg-highlight highlight2"/>
      <rect class="svg-highlight highlight3"/>
      <rect class="svg-highlight highlight4"/>
      <rect class="svg-highlight highlight5"/>
    </svg>
  </div> -->

  <style>
    .svg-highlight.prepared {
      visibility: hidden;
    }

    .context-box1 .current {
      visibility: visible;
    }



    .fancybox-auto svg {
      max-height: 90vh;
    }

    .fancybox-auto {
      cursor:zoom-in;
    }

    .svg-highlight {
      stroke: yellow;
      stroke-width: 25;
      fill: none;
      animation: highlight-bounce 3s linear infinite;
    }
    svg:hover .svg-highlight {
      animation: highlight-bounce 6s linear infinite;
    }

    /* .highlight-max .svg-highlight {
      stroke-width: 200;
    } */



    /* .context-box1 .highlight1 {
      x: 19%;
      y: 82%;
      width: 64%;
      height: 18%;
    } */

    .context-box2 .highlight1 {
      x: 19%;
      y: 82%;
      width: 64%;
      height: 18%;
    }
    @keyframes highlight-bounce {
      0%, 100% { stroke: gold }
      20%, 80% {stroke: cornsilk }
      50% {stroke: black}
    }
  </style>

  <script>

    function attachFancybox() {
      var containers = $(".fancybox-auto");
      // add ID if missing
      containers.each(function(i, e) {
        if(!e.id) e.id = 'rndId-' + Math.floor(Math.random() * Math.floor(9999999))

        // check if we need to attach some classes from parent
        var pcls = $(e).parent().attr("class");
        if(pcls) {
          var clsList = pcls.split(' ');
          var contextCls = clsList.find(c => c.startsWith('context'));
          if(contextCls) $(e).addClass(contextCls);
        }
      });
      // attach click
      containers.click(function() {
        showDivWithSvg(this.id);
      });
    } 
    $(attachFancybox);

    function showDivWithSvg(target) {
      var newName = target + '-clone';
      var clone = document.getElementById(newName);
      if(!clone) {
        clone = document.getElementById(target).cloneNode(true);
        clone.id = newName;
        clone.style.width = "95%";
        $(clone).click(function() { $.fancybox.close() })
        document.body.appendChild(clone);
      }
      // var original = document.getElementById(target);
      $.fancybox.open( {
        src: '#' + newName,
        type: 'inline',
      });
    }
  </script>
</body>
</html>